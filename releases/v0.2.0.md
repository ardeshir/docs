# DOL v0.2.0 Release Notes

**Codename:** Meta-Programming
**Date:** December 25, 2024
**Tests:** 590 passing

## Highlights

DOL v0.2.0 completes Q2 of the Year 1 roadmap with full meta-programming support. You can now manipulate DOL code as data, reflect on types at runtime, and use macros for compile-time code generation.

## New Features

### Quote and Eval

Capture expressions as AST data and evaluate them dynamically:

```dol
// Quote captures AST
ast = '(1 + 2 * 3)    // Quoted<Int64>

// Eval executes quoted expressions
result = !ast         // 7

// Round-trip preservation
!'(x + y) where { x = 10, y = 5 }  // 15
```

### Quasi-Quote and Unquote

Build AST templates with dynamic holes:

```dol
x = 5
template = `(1 + ~x)   // Splice x into template
result = !template     // 6

fun make_adder(n: Int64) -> Quoted<Expr> {
    return `(x + ~n)
}
```

### Reflection

Get type information at runtime with the `?` operator:

```dol
gene Person {
    has name: String
    has age: Int64
}

info = ?Person
for field in info.fields {
    println(field.name + ": " + field.type_name)
}

// Check trait implementation
if ?Person.implements(Serializable) {
    serialize(person)
}
```

### Idiom Brackets

Applicative functor syntax sugar:

```dol
// Instead of:
result = add <$> mx <*> my

// Write:
result = [| add mx my |]

// Desugaring:
// [| f |]       ->  f
// [| f a |]     ->  f <$> a
// [| f a b |]   ->  (f <$> a) <*> b
```

### Macros

18 built-in macros for code generation and compile-time operations:

```dol
#derive(Debug, Clone)
gene Container {
    has id: UInt64
    has name: String
}

// Conditional compilation
#cfg(target.wasm)
fun platform_init() { wasm_init() }

// Debug printing
value = #dbg(compute_something())

// Assertions
#assert(count > 0, "count must be positive")
#assert_eq(expected, actual)

// String operations
msg = #format("Hello, {}!", name)
```

## Operator Precedence

| Operator | Name | Precedence | Associativity |
|----------|------|------------|---------------|
| `'` | Quote | 135 | Prefix |
| `!` | Eval | 130 | Prefix |
| `?` | Reflect | 135 | Prefix |

## Implementation Details

### Key Files

| File | Purpose |
|------|---------|
| `src/ast.rs:147-152` | AST node definitions for meta-operators |
| `src/eval/interpreter.rs:147-197` | Quote/Eval/Reflect evaluation logic |
| `src/typechecker.rs` | `Quoted<T>` type inference |
| `src/macros/` | 18 built-in macro implementations |
| `src/reflect.rs` | TypeInfo, FieldInfo, MethodInfo, TypeRegistry |
| `src/transform/desugar_idiom.rs` | Idiom bracket desugaring pass |

### Test Coverage

- Quote/Eval: 34 tests
- Reflect: 17 tests
- Idiom Brackets: 27 tests
- Macros: 25+ tests
- Total: 590 tests passing

## Upgrade Guide

No breaking changes from v0.1.0. Simply pull the latest and rebuild:

```bash
cd ~/repos/univrs-dol
git pull
cargo build --release
cargo test
```

## What's Next

- **Q3**: LLVM/WASM backend compilation
- **Q4**: Self-hosting compiler (DOL written in DOL)

## Contributors

- DOL Core Team
- Claude Code (AI-assisted development)

---

*Released December 25, 2024*
